<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="configuration.xsl"?>

<configuration>

  <property>
    <name>mapred.job.tracker</name>
    <value><%= jobtracker -%>:8021</value>
    <final>true</final>
  </property>

  <property>
    <name>mapred.local.dir</name>
    <value><%= hadoop_disks.collect {|hadoop_disk| hadoop_disk + "/hadoop/mapreduce/local"}.join(',') -%></value>
    <final>true</final>
  </property>

  <property>
    <name>mapred.system.dir</name>
    <value>/mapred/system</value>
    <final>true</final>
  </property>

  <property>
    <name>mapreduce.jobtracker.staging.root.dir</name>
    <value>/user</value>
  </property>

  <property>
    <name>mapred.jobtracker.taskScheduler</name>
    <value>org.apache.hadoop.mapred.FairScheduler</value>
  </property>

  <property>
    <name>mapred.fairscheduler.allocation.file</name>
    <value>/etc/hadoop-0.20/conf/fair-scheduler.xml</value>
  </property>

  <property>
    <name>mapred.fairscheduler.assignmultiple</name>
    <value>true</value>
  </property>

  <property>
    <name>mapred.fairscheduler.sizebasedweight</name>
    <value>true</value>
  </property>

  <property>
    <name>mapred.map.tasks</name>
    <value>50</value>
  </property>

  <property>
    <name>mapred.reduce.tasks</name>
    <value>50</value>
  </property>

  <property>
    <name>mapred.tasktracker.map.tasks.maximum</name>
    <value><%= max_maps %></value>
    <final>true</final>
  </property>

  <property>
    <name>mapred.tasktracker.reduce.tasks.maximum</name>
    <value><%= max_reduces %></value>
    <final>true</final>
  </property>

  <property>
    <name>mapred.child.java.opts</name>
    <value>-Xmx<%= max_memory %>m</value>
  </property>

<!--  
  <property>
    <name>jobtracker.thrift.address</name>
    <value>0.0.0.0:9290</value>
  </property>

  <property>
    <name>mapred.jobtracker.plugins</name>
    <value>org.apache.hadoop.thriftfs.ThriftJobTrackerPlugin</value>
  </property>
-->

  <property>
    <name>mapred.hosts</name>
    <value>/etc/hadoop/conf/allowed_hosts</value>
  </property>

  <property>
    <name>mapred.hosts.exclude</name>
    <value>/etc/hadoop/conf/excluded_hosts</value>
  </property>

  <property>
    <name>mapred.tasktracker.expiry.interval</name>
    <value>180000</value>
  </property>

  <property>
    <name>mapred.compress.map.output</name>
    <value>true</value>
  </property>

  <property>
    <name>mapred.map.output.compression.codec</name>
    <value>org.apache.hadoop.io.compress.SnappyCodec</value>
  </property>

  <property>
    <name>mapred.output.compression.codec</name>
    <value>org.apache.hadoop.io.compress.SnappyCodec</value>
  </property>

  <property>
    <name>io.sort.factor</name>
    <value>100</value>
  </property>

  <property>
    <name>tasktracker.http.threads</name>
    <value>80</value>
    <final>true</final>
  </property>
  
  <property>
    <name>mapred.userlog.retain.hours</name>
    <value>72</value>
    <final>true</final>
  </property>

</configuration>
